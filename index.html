<!DOCTYPE html>
<html>
  <head>
    <title>Фото-Клик AI: Ваша персональная фотосессия</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Создавайте профессиональные фотосессии и невероятные вариации ваших снимков с помощью искусственного интеллекта. Загрузите фото и преобразите его за секунды!">
    
    <!-- PWA & Icons -->
    <link rel="manifest" href="/manifest.json">
    <link rel="icon" type="image/png" href="/icon-192.png">
    <link rel="apple-touch-icon" href="/icon-192.png">
    <meta name="theme-color" content="#191423">
    
    <!-- Open Graph Meta Tags for Social Media Previews -->
    <meta property="og:title" content="Фото-Клик AI: Ваша персональная фотосессия" />
    <meta property="og:description" content="Создавайте профессиональные фотосессии и невероятные вариации ваших снимков с помощью искусственного интеллекта. Загрузите фото и преобразите его за секунды!" />
    <meta property="og:image" content="https://photo-click-ai.ru/og-image.png" />
    <meta property="og:url" content="https://photo-click-ai.ru" />
    <meta property="og:type" content="website" />

    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Manrope:wght@400;500;700&family=Playfair+Display:ital,wght@0,400..900;1,400..900&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="/index.css" />

<script type="importmap">
{
  "imports": {
    "cors": "https://aistudiocdn.com/cors@^2.8.5",
    "url": "https://aistudiocdn.com/url@^0.11.4",
    "@vitejs/plugin-react": "https://aistudiocdn.com/@vitejs/plugin-react@^5.1.1",
    "idb": "https://aistudiocdn.com/idb@^8.0.3",
    "crypto": "https://aistudiocdn.com/crypto@^1.0.1",
    "path": "https://aistudiocdn.com/path@^0.12.7",
    "vite": "https://aistudiocdn.com/vite@^7.2.2",
    "dotenv": "https://aistudiocdn.com/dotenv@^17.2.3",
    "express": "https://aistudiocdn.com/express@^5.1.0",
    "@google/genai": "https://aistudiocdn.com/@google/genai@^1.29.1",
    "google-auth-library": "https://aistudiocdn.com/google-auth-library@^10.5.0",
    "module": "https://aistudiocdn.com/module@^2.0.0",
    "lowdb/": "https://aistudiocdn.com/lowdb@^7.0.1/",
    "lowdb": "https://aistudiocdn.com/lowdb@^7.0.1",
    "react-dom/": "https://aistudiocdn.com/react-dom@^19.2.0/",
    "react/": "https://aistudiocdn.com/react@^19.2.0/",
    "react": "https://aistudiocdn.com/react@^19.2.0",
    "jsonwebtoken": "https://aistudiocdn.com/jsonwebtoken@^9.0.2",
    "https": "https://aistudiocdn.com/https@^1.0.0",
    "https-proxy-agent": "https://aistudiocdn.com/https-proxy-agent@^7.0.6",
    "socks-proxy-agent": "https://aistudiocdn.com/socks-proxy-agent@^8.0.5"
  }
}
</script>
<link rel="stylesheet" href="/index.css">
</head>
  <body class="antialiased">
    <div
      class="min-h-screen flex items-center justify-center p-4"
      role="main"
    >
      <div
        class="app-container px-8 pt-8 pb-6 rounded-2xl shadow-2xl w-full max-w-5xl"
      >
        <!-- Combined Header: Promo, Nav, Credits -->
        <div class="flex flex-wrap items-center justify-between gap-4 border-b border-[var(--border-color)] mb-6 pb-4">
            <!-- Left: Promo Code -->
            <div id="promo-code-container" class="order-1 flex items-center gap-1 bg-black/30 backdrop-blur-sm p-1 rounded-full text-sm">
                <input type="text" id="promo-code-input" placeholder="Промокод" class="bg-transparent focus:outline-none placeholder-gray-400 w-24 sm:w-28 px-2 appearance-none">
                <button id="apply-promo-button" class="promo-button">Применить</button>
            </div>

            <!-- Center: App Navigation -->
            <nav id="app-nav" class="order-3 sm:order-2 w-full sm:w-auto flex flex-wrap justify-center gap-2">
              <button data-page="page1" class="nav-button active">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                  <path fill-rule="evenodd" d="M4 5a2 2 0 00-2 2v8a2 2 0 002 2h12a2 2 0 002-2V7a2 2 0 00-2-2h-1.586a1 1 0 01-.707-.293l-1.121-1.121A2 2 0 0011.172 3H8.828a2 2 0 00-1.414.586L6.293 4.707A1 1 0 015.586 5H4zm6 9a3 3 0 100-6 3 3 0 000 6z" clip-rule="evenodd" />
                </svg>
                <span>Фотосессия</span>
              </button>
              <button data-page="page2" class="nav-button">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                  <path fill-rule="evenodd" d="M3 3a1 1 0 00-1 1v12a1 1 0 102 0V5h10a1 1 0 100-2H3zm12 4a1 1 0 011 1v7a1 1 0 01-1 1H9a1 1 0 01-1-1V8a1 1 0 011-1h6zm-1 2a1 1 0 10-2 0v1h-1a1 1 0 100 2h1v1a1 1 0 102 0v-1h1a1 1 0 100-2h-1V9z" clip-rule="evenodd" />
                </svg>
                <span>4 Вариации</span>
              </button>
              <button data-page="page-business" class="nav-button">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                  <path fill-rule="evenodd" d="M6 6V5a3 3 0 013-3h2.25a3 3 0 013 3v1h2a2 2 0 012 2v9a2 2 0 01-2 2H4a2 2 0 01-2-2V8a2 2 0 012-2h2zm2.5-.5a.5.5 0 01.5-.5h3a.5.5 0 01.5.5V6h-4v-.5z" clip-rule="evenodd" />
                </svg>
                <span>Бизнес</span>
              </button>
              <button data-page="page3" class="nav-button">
                 <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                    <path d="M7 3a1 1 0 000 2h6a1 1 0 100-2H7zM4 7a1 1 0 011-1h10a1 1 0 110 2H5a1 1 0 01-1-1zM2 11a2 2 0 012-2h12a2 2 0 012 2v4a2 2 0 01-2 2H4a2 2 0 01-2-2v-4z"></path>
                 </svg>
                 <span>История</span>
              </button>
            </nav>

            <!-- Right side: Credits & Auth -->
            <div class="order-2 sm:order-3 flex items-center gap-4">
                <div id="credit-counter" class="credit-counter-glow bg-black/30 backdrop-blur-sm px-3 py-1.5 rounded-full text-base font-semibold flex items-center gap-1.5 cursor-pointer" title="Пополнить кредиты">
                    <!-- SVG and spans will be inserted here by JS -->
                </div>
                <div id="auth-container">
                     <div id="google-signin-container">
                         <!-- Google Button will be rendered here by JS -->
                     </div>
                     <div id="user-profile-container" class="hidden items-center gap-2 cursor-pointer p-1 pr-3 rounded-full hover:bg-white/10 transition-colors border border-[var(--border-color)]" title="Выйти">
                         <img id="user-profile-image" class="h-9 w-9 rounded-full object-cover" src="" alt="Аватар пользователя" />
                         <span id="user-profile-name" class="hidden lg:block text-sm font-semibold"></span>
                     </div>
                 </div>
            </div>
        </div>
        
        <!-- Page 1 Content -->
        <div id="page1" class="page-content">
           <div class="text-center">
             <h1 class="app-title tracking-tight">
              Фото-Клик
            </h1>
             <p id="page1-subtitle" class="text-gray-400 mt-2 text-sm transition-all duration-300">Шаг 1: Загрузите ваше фото для начала</p>
           </div>
           <div class="flex flex-col items-center gap-6 mt-6">
             <!-- Step 1: Your Photo Uploader -->
             <div class="page1-window w-full max-w-xl mx-auto">
                <div id="page1-upload-container" class="page1-window-upload w-full h-full cursor-pointer relative min-h-[500px]">
                    <div id="page1-upload-placeholder" class="w-full h-full">
                        <!-- Placeholder content is injected by JavaScript -->
                    </div>
                    <img id="page1-image-preview" class="hidden h-full w-full object-cover rounded-lg" alt="Превью вашего фото" />
                    <input type="file" id="page1-image-upload" class="hidden" accept="image/png, image/jpeg, image/webp" />
                    <button id="page1-clear-button" class="clear-button hidden" title="Очистить">
                      <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd" /></svg>
                    </button>
                </div>
                
                <!-- Extra Faces Slots Page 1 -->
                <div class="w-full mt-4 flex justify-center gap-4">
                     <!-- Slot 1 -->
                     <div id="page1-extra-face-1" class="extra-face-uploader cursor-pointer relative" title="Доп. фото для лучшей узнаваемости (например, с улыбкой)">
                        <div class="extra-placeholder flex flex-col items-center justify-center h-full">
                           <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"/></svg>
                           <span class="text-[10px] text-gray-500 mt-1">Доп. фото</span>
                        </div>
                        <img class="hidden w-full h-full object-cover rounded-lg" />
                        <input type="file" class="hidden" accept="image/png, image/jpeg, image/webp" />
                        <button class="remove-extra hidden absolute -top-2 -right-2 bg-red-500 text-white rounded-full p-0.5"><svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3" viewBox="0 0 20 20" fill="currentColor"><path d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z"/></svg></button>
                     </div>
                     <!-- Slot 2 -->
                     <div id="page1-extra-face-2" class="extra-face-uploader cursor-pointer relative" title="Доп. фото для лучшей узнаваемости">
                        <div class="extra-placeholder flex flex-col items-center justify-center h-full">
                           <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"/></svg>
                           <span class="text-[10px] text-gray-500 mt-1">Доп. фото</span>
                        </div>
                        <img class="hidden w-full h-full object-cover rounded-lg" />
                        <input type="file" class="hidden" accept="image/png, image/jpeg, image/webp" />
                        <button class="remove-extra hidden absolute -top-2 -right-2 bg-red-500 text-white rounded-full p-0.5"><svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3" viewBox="0 0 20 20" fill="currentColor"><path d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z"/></svg></button>
                     </div>
                </div>
                <p class="text-xs text-gray-500 mt-2 text-center">Загрузите до 3-х фото с разными эмоциями (например, с улыбкой) для лучшей узнаваемости в вариациях.</p>

            </div>
            
            <!-- Step 2 & 3: Clothing and Location (Combined) -->
            <div id="clothing-location-container" class="hidden w-full">
               <div class="flex flex-col md:flex-row gap-6 justify-center">

                 <!-- Clothing Section -->
                 <div class="step-container flex-1 w-full max-w-md">
                   <div class="page1-window">
                     <div class="w-full flex justify-between items-center mb-2">
                       <p class="font-semibold text-xl">ОДЕЖДА</p>
                       <button id="refresh-clothing-suggestions" class="refresh-suggestions-button" title="Новые идеи">
                         <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M4 2a1 1 0 011 1v2.101a7.002 7.002 0 0111.601 2.566 1 1 0 11-1.885.666A5.002 5.002 0 005.999 7H9a1 1 0 110 2H4a1 1 0 01-1-1V3a1 1 0 011-1zm.008 9.057a1 1 0 011.276.61A5.002 5.002 0 0014.001 13H11a1 1 0 110-2h5a1 1 0 011 1v5a1 1 0 11-2 0v-2.101a7.002 7.002 0 01-11.601-2.566 1 1 0 01.61-1.276z" clip-rule="evenodd" /></svg>
                       </button>
                     </div>
                     <div class="flex flex-col sm:flex-row gap-4 w-full items-start">
                       <div class="flex-grow w-full">
                         <input type="text" id="clothing-prompt" placeholder="Опишите или выберите вариант..." class="page1-text-input w-full" />
                         <div id="clothing-suggestions-container" class="suggestions-container">
                         </div>
                       </div>
                       <div class="flex-shrink-0 flex items-center gap-2">
                         <div id="clothing-upload-container" class="page1-window-small-upload cursor-pointer relative">
                           <div id="clothing-upload-placeholder" class="page1-upload-placeholder-small">
                             <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-gray-500" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z" /></svg>
                             <span class="text-xs mt-1 text-gray-400">Фото одежды</span>
                           </div>
                           <img id="clothing-image-preview" class="hidden h-full w-full object-cover rounded-md" alt="Превью одежды" />
                           <input type="file" id="clothing-image-upload" class="hidden" accept="image/png, image/jpeg, image/webp" />
                           <button id="clothing-clear-button" class="clear-button-small hidden" title="Очистить">
                             <svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd" /></svg>
                           </button>
                         </div>
                         <a href="https://www.wildberries.ru" target="_blank" rel="noopener noreferrer" id="wildberries-link" class="page1-window-small-upload cursor-pointer relative no-underline" title="Открыть Wildberries в новой вкладке">
                           <div class="page1-upload-placeholder-small">
                               <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-gray-500" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"></path></svg>
                               <span class="text-xs mt-1 text-gray-400">Wildberries</span>
                           </div>
                         </a>
                       </div>
                     </div>
                     <p class="text-xs text-gray-400 mt-3 text-center max-w-sm mx-auto">
                       Опишите одежду, выберите идею, загрузите фото или <strong class="font-semibold text-[var(--font-color)]">найдите образ в магазине, сделайте скриншот</strong> и загрузите его.
                     </p>
                   </div>
                 </div>

                 <!-- Location Section -->
                 <div class="step-container flex-1 w-full max-w-md">
                   <div class="page1-window">
                     <div class="w-full flex justify-between items-center mb-2">
                       <p class="font-semibold text-xl">ЛОКАЦИЯ</p>
                       <button id="refresh-location-suggestions" class="refresh-suggestions-button" title="Новые идеи">
                         <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M4 2a1 1 0 011 1v2.101a7.002 7.002 0 0111.601 2.566 1 1 0 11-1.885.666A5.002 5.002 0 005.999 7H9a1 1 0 110 2H4a1 1 0 01-1-1V3a1 1 0 011-1zm.008 9.057a1 1 0 011.276.61A5.002 5.002 0 0014.001 13H11a1 1 0 110-2h5a1 1 0 011 1v5a1 1 0 11-2 0v-2.101a7.002 7.002 0 01-11.601-2.566 1 1 0 01.61-1.276z" clip-rule="evenodd" /></svg>
                       </button>
                     </div>
                     <div class="flex flex-col sm:flex-row gap-4 w-full items-start">
                       <div class="flex-grow w-full">
                         <input type="text" id="location-prompt" placeholder="Опишите или выберите вариант..." class="page1-text-input w-full" />
                         <div id="location-suggestions-container" class="suggestions-container">
                         </div>
                       </div>
                       <div class="flex-shrink-0">
                         <div id="location-upload-container" class="page1-window-small-upload cursor-pointer relative">
                           <div id="location-upload-placeholder" class="page1-upload-placeholder-small">
                             <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-gray-500" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6" /></svg>
                             <span class="text-xs mt-1 text-gray-400">Фото локации</span>
                           </div>
                           <img id="location-image-preview" class="hidden h-full w-full object-cover rounded-md" alt="Превью локации" />
                           <input type="file" id="location-image-upload" class="hidden" accept="image/png, image/jpeg, image/webp" />
                           <button id="location-clear-button" class="clear-button-small hidden" title="Очистить">
                             <svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd" /></svg>
                           </button>
                         </div>
                       </div>
                     </div>
                     <p class="text-xs text-gray-400 mt-3 text-center max-w-sm mx-auto">
                       Опишите текстом, выберите идею или загрузите фото для анализа.
                     </p>
                   </div>
                 </div>

               </div>
            </div>

           </div>

            <!-- Generate Button and Result -->
            <div class="mt-8 flex flex-col items-center">
                <div id="page1-action-container" class="w-full flex justify-center">
                    <button id="generate-photoshoot-button" class="btn-primary flex-grow">
                        Начать фотосессию (1 кредит)
                    </button>
                </div>

                <div id="photoshoot-result-container" class="w-full max-w-2xl mt-6 min-h-[300px] flex items-center justify-center">
                  <!-- Result will be injected here -->
                </div>
            </div>
        </div>

        <!-- Page 2 Content (Existing App) -->
        <div id="page2" class="page-content hidden">
          <div class="text-center">
            <h1 class="app-title tracking-tight">
              Фото-Клик
            </h1>
            <p class="text-gray-400 mt-2 text-sm">
              ЗАГРУЗИТЕ ВАШЕ ИЗОБРАЖЕНИЕ, ВЫБЕРЕТЕ ПЛАН СЪЕМКИ И СОЗДАЙТЕ ВАШУ ФОТОСЕССИЮ.
              <br />
              Кликните на результат, чтобы сделать его новым референсом.
            </p>
          </div>

          <div class="space-y-4 mt-6">
            <!-- Image Upload & Plan Selection -->
            <div class="flex flex-col md:flex-row gap-4">
              <!-- Image Upload & Preview -->
              <div class="flex-1 md:flex-[2] flex flex-col gap-4">
                  <div
                    id="upload-container"
                    class="uploader-box aspect-square max-h-[420px] flex items-center justify-center rounded-lg p-4 text-center cursor-pointer transition-colors relative"
                  >
                    <div id="upload-placeholder" class="flex flex-col items-center justify-center">
                      <p class="text-gray-400">Нажмите, чтобы загрузить референс</p>
                      <p class="text-xs text-gray-500 mt-1">PNG, JPG, WEBP</p>
                    </div>
                    <img
                      id="reference-image-preview"
                      class="hidden max-h-full max-w-full object-contain rounded-md"
                      alt="Превью загруженного изображения"
                    />
                    <input
                      type="file"
                      id="image-upload"
                      class="hidden"
                      accept="image/png, image/jpeg, image/webp"
                    />
                    <a href="#" id="reference-download-button" class="absolute bottom-2 right-2 bg-black bg-opacity-50 text-white p-2 rounded-full hover:bg-opacity-75 transition-colors z-20 hidden" title="Скачать изображение">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                          <path fill-rule="evenodd" d="M3 17a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm3.293-7.707a1 1 0 011.414 0L9 10.586V3a1 1 0 112 0v7.586l1.293-1.293a1 1 0 111.414 1.414l-3 3a1 1 0 01-1.414 0l-3-3a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                        </svg>
                    </a>
                  </div>

                  <!-- Extra Faces Slots Page 2 -->
                   <div class="w-full flex justify-center gap-4">
                     <!-- Slot 1 -->
                     <div id="page2-extra-face-1" class="extra-face-uploader cursor-pointer relative" title="Доп. фото для лучшей узнаваемости">
                        <div class="extra-placeholder flex flex-col items-center justify-center h-full">
                           <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"/></svg>
                           <span class="text-[10px] text-gray-500 mt-1">Доп. фото</span>
                        </div>
                        <img class="hidden w-full h-full object-cover rounded-lg" />
                        <input type="file" class="hidden" accept="image/png, image/jpeg, image/webp" />
                        <button class="remove-extra hidden absolute -top-2 -right-2 bg-red-500 text-white rounded-full p-0.5"><svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3" viewBox="0 0 20 20" fill="currentColor"><path d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z"/></svg></button>
                     </div>
                     <!-- Slot 2 -->
                     <div id="page2-extra-face-2" class="extra-face-uploader cursor-pointer relative" title="Доп. фото для лучшей узнаваемости">
                         <div class="extra-placeholder flex flex-col items-center justify-center h-full">
                           <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"/></svg>
                           <span class="text-[10px] text-gray-500 mt-1">Доп. фото</span>
                        </div>
                        <img class="hidden w-full h-full object-cover rounded-lg" />
                        <input type="file" class="hidden" accept="image/png, image/jpeg, image/webp" />
                        <button class="remove-extra hidden absolute -top-2 -right-2 bg-red-500 text-white rounded-full p-0.5"><svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3" viewBox="0 0 20 20" fill="currentColor"><path d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z"/></svg></button>
                     </div>
                  </div>
                   <p class="text-xs text-gray-500 mt-0 text-center">Загрузите до 3-х фото с разными эмоциями (например, с улыбкой) для лучшей узнаваемости в вариациях.</p>

              </div>
              
              <!-- Plan Buttons -->
              <div
                id="plan-buttons"
                class="flex-1 flex flex-col justify-center gap-2"
              >
                <button
                  data-plan="close_up"
                  class="plan-button w-full"
                >
                  Крупный план
                </button>
                <button
                  data-plan="medium_shot"
                  class="plan-button w-full"
                >
                  Средний план
                </button>
                <button
                  data-plan="full_shot"
                  class="plan-button w-full"
                >
                  Общий план
                </button>
              </div>
            </div>
            <!-- Custom Prompt Input -->
            <div id="custom-prompt-container">
              <input
                type="text"
                id="custom-prompt-input"
                placeholder="Добавьте детали: цветы в руках, автомобиль на фоне..."
                class="w-full page1-text-input"
              />
            </div>
          </div>

          <div class="flex w-full items-stretch gap-4 mt-6">
            <button
              id="generate-button"
              class="btn-primary flex-grow"
            >
              создать 4 фотографии
            </button>
            <button
              id="reset-button"
              title="Начать заново"
              class="btn-secondary flex-shrink-0 flex items-center justify-center gap-2"
            >
              <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M21 2v6h-6"/><path d="M21 13a9 9 0 1 1-3-7.7L21 8"/>
              </svg>
              <span>Сброс</span>
            </button>
          </div>

          <div class="w-full mt-6">
            <div id="output-gallery" class="grid grid-cols-2 gap-4 items-start"></div>
          </div>
          
          <!-- Progress Bar -->
          <div id="progress-container" class="w-full max-w-lg mx-auto mt-6 hidden">
              <div id="progress-text" class="text-center text-lg font-medium text-white mb-2">Генерация... 0%</div>
              <div class="w-full bg-gray-700 rounded-full h-2.5">
                  <div id="progress-bar" class="bg-blue-600 h-2.5 rounded-full transition-all duration-300 ease-linear" style="width: 0%"></div>
              </div>
              <p class="text-center text-gray-500 text-sm mt-2">Это может занять от 30 секунд до 2 минут. Пожалуйста, подождите.</p>
          </div>

          <p id="status" class="text-center min-h-[24px] mt-2"></p>

        </div>

        <!-- NEW PAGE: Business -->
        <div id="page-business" class="page-content hidden">
           <div class="text-center">
             <h1 class="app-title tracking-tight">Бизнес фотосессия</h1>
             <p class="text-gray-400 mt-2 text-sm">Загрузите фото товара (обязательно) и до 2 референсов (фон/стиль).</p>
           </div>
           
           <div class="mt-8 flex flex-col md:flex-row gap-4 items-stretch justify-center">
                <!-- Product Uploader (Main) -->
                <div class="flex-1 flex flex-col gap-2">
                    <p class="text-center font-bold text-[var(--font-color)]">Фото Товара (Главное)</p>
                    <div id="business-upload-product" class="page1-window-upload w-full h-64 cursor-pointer relative">
                        <div id="business-placeholder-product" class="flex flex-col items-center justify-center h-full">
                           <svg xmlns="http://www.w3.org/2000/svg" class="h-10 w-10 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z" /></svg>
                           <p class="text-sm text-gray-500 mt-2">Загрузить товар</p>
                        </div>
                        <img id="business-preview-product" class="hidden h-full w-full object-contain rounded-lg" />
                        <input type="file" id="business-input-product" class="hidden" accept="image/png, image/jpeg, image/webp" />
                        <button id="business-clear-product" class="clear-button hidden"><svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd" /></svg></button>
                    </div>
                </div>

                <!-- Reference 1 -->
                <div class="flex-1 flex flex-col gap-2">
                    <p class="text-center font-bold text-[var(--font-color)]">Референс 1 (Фон/Стиль)</p>
                    <div id="business-upload-ref1" class="page1-window-upload w-full h-64 cursor-pointer relative">
                        <div id="business-placeholder-ref1" class="flex flex-col items-center justify-center h-full">
                           <svg xmlns="http://www.w3.org/2000/svg" class="h-10 w-10 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z" /></svg>
                           <p class="text-sm text-gray-500 mt-2">Загрузить пример</p>
                        </div>
                        <img id="business-preview-ref1" class="hidden h-full w-full object-cover rounded-lg" />
                        <input type="file" id="business-input-ref1" class="hidden" accept="image/png, image/jpeg, image/webp" />
                        <button id="business-clear-ref1" class="clear-button hidden"><svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd" /></svg></button>
                    </div>
                </div>

                <!-- Reference 2 -->
                <div class="flex-1 flex flex-col gap-2">
                    <p class="text-center font-bold text-[var(--font-color)]">Референс 2 (Окружение)</p>
                    <div id="business-upload-ref2" class="page1-window-upload w-full h-64 cursor-pointer relative">
                         <div id="business-placeholder-ref2" class="flex flex-col items-center justify-center h-full">
                           <svg xmlns="http://www.w3.org/2000/svg" class="h-10 w-10 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z" /></svg>
                           <p class="text-sm text-gray-500 mt-2">Загрузить пример</p>
                        </div>
                        <img id="business-preview-ref2" class="hidden h-full w-full object-cover rounded-lg" />
                        <input type="file" id="business-input-ref2" class="hidden" accept="image/png, image/jpeg, image/webp" />
                        <button id="business-clear-ref2" class="clear-button hidden"><svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd" /></svg></button>
                    </div>
                </div>
           </div>

           <div class="mt-6 w-full max-w-2xl mx-auto">
               <textarea id="business-prompt-input" rows="4" class="page1-text-input w-full" placeholder="Опишите, что должно быть на карточке...">Сделай 4 разных карточки товара с главного фото.Стилистика фона должна соответствовать референсу 1 и товар должен идеально вписываться в фон.Добавь текст способствующий продаже товара на главной странице в стилистике фона.Преобрази товар так что бы покупатель хотел его купить.добавь  элементы  товара  в карточку отдельными окнами .Добавь параметры и обозначения товара.</textarea>
               <button id="generate-business-button" class="btn-primary w-full mt-4">
                  Создать карточки товара (4 вариации)
               </button>
           </div>
           
           <!-- Reuse output gallery for business results -->
           <div class="w-full mt-6">
             <div id="business-output-gallery" class="grid grid-cols-2 gap-4 items-start"></div>
           </div>
        </div>

        <!-- Page 3: History -->
        <div id="page3" class="page-content hidden">
            <div class="text-center">
                <h1 class="app-title tracking-tight">
                    История генераций
                </h1>
                <p class="text-gray-400 mt-2 text-sm">
                    Здесь хранятся 50 ваших последних генераций.
                </p>
            </div>
            <div class="w-full mt-6">
                <div id="history-gallery" class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4 items-start">
                  <!-- History images will be injected here -->
                </div>
            </div>
        </div>


        <footer class="app-footer">
          <p>Самозанятый: Кайгородов Дмитрий Николаевич | ИНН: 666002617267</p>
          <p>Для связи: WhatsApp +79292216920</p>
          <div class="footer-links">
            <a href="#">Пользовательское соглашение</a>
            <span>&bull;</span>
            <a href="#">Политика конфиденциальности</a>
          </div>
        </footer>

      </div>
    </div>
    
    <!-- Lightbox Modal -->
    <div id="lightbox-overlay" class="fixed inset-0 bg-black/80 flex items-center justify-center z-50 opacity-0 pointer-events-none transition-opacity duration-300 p-4">
      <img id="lightbox-image" src="" class="max-w-full max-h-full object-contain" alt="Увеличенное изображение" />
      <button id="lightbox-close-button" class="lightbox-close-btn">Свернуть</button>
    </div>
    
    <!-- Payment Modal -->
    <div id="payment-modal-overlay" class="payment-modal-overlay hidden">
      <div class="payment-modal-content">
        <button id="payment-close-button" class="absolute top-4 right-4 text-gray-400 hover:text-white transition-colors" title="Закрыть">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" /></svg>
        </button>
        
        <!-- Step 1: Selection -->
        <div id="payment-selection-view">
            <div class="text-center">
                <h2 id="payment-modal-title" class="text-2xl font-bold mb-2">Разблокируйте больше фотографий!</h2>
                <p id="payment-modal-description" class="mb-6">Пополните баланс, чтобы продолжить генерацию.</p>
            </div>
            
            <div class="bg-gray-800/50 border border-[var(--border-color)] rounded-lg p-6 flex flex-col items-center gap-4">
                 <div class="w-full text-center">
                     <p class="text-sm mb-2">Выберите тариф:</p>
                     
                     <div class="flex flex-col gap-3 w-full mb-6">
                         <!-- Пакет "Стандарт" -->
                         <div id="plan-small" class="payment-plan-card selected p-4 rounded-lg border-2 border-[var(--secondary-color)] bg-[var(--bg-color)] cursor-pointer flex justify-between items-center transition-all">
                             <div>
                                 <p class="font-bold text-lg">12 Фотографий</p>
                                 <p class="text-sm text-gray-500">Попробовать</p>
                             </div>
                             <p class="font-bold text-xl">129 ₽</p>
                         </div>

                         <!-- Пакет "PRO" -->
                         <div id="plan-large" class="payment-plan-card p-4 rounded-lg border border-[var(--border-color)] hover:border-[var(--secondary-color)] bg-[var(--bg-color)] cursor-pointer flex justify-between items-center transition-all relative overflow-hidden">
                             <div class="absolute top-0 right-0 bg-[#E0C9A6] text-black text-[10px] px-2 py-0.5 font-bold rounded-bl-lg">ВЫГОДНО</div>
                             <div>
                                 <p class="font-bold text-lg">60 Фотографий</p>
                                 <p class="text-sm text-gray-500">Большая фотосессия</p>
                             </div>
                             <p class="font-bold text-xl">500 ₽</p>
                         </div>
                     </div>
                 </div>
                 
                 <div class="w-full h-px bg-[var(--border-color)] my-2"></div>

                 <button id="payment-proceed-button" class="btn-primary w-full mt-4">
                     Перейти к оплате 129 ₽
                 </button>
            </div>
        </div>

        <!-- Step 2: Processing / Loading -->
        <div id="payment-processing-view" class="hidden text-center py-12">
            <div class="loading-spinner large mx-auto"></div>
            <p class="mt-4 font-semibold">Перенаправляем на страницу оплаты...</p>
            <p class="text-sm mt-1">Это может занять несколько секунд.</p>
        </div>

        <!-- Step 2b: QR Code Display -->
        <div id="payment-qr-view" class="hidden text-center py-4">
            <h2 class="text-xl font-bold mb-2">Оплата через SberPay</h2>
            <p class="mb-4">Отсканируйте QR-код в приложении СберБанк Онлайн</p>
            <div class="bg-white p-2 rounded-lg inline-block">
                <img id="payment-qr-image" src="" alt="QR-код для оплаты" class="w-48 h-48 mx-auto" />
            </div>
            <p class="text-2xl font-bold mt-4">129 ₽</p>
            <button id="payment-back-button" class="btn-secondary w-full mt-6">Выбрать другой способ</button>
        </div>

        <!-- Step 3: Final Confirmation -->
        <div id="payment-final-view" class="hidden text-center">
            <h2 class="text-2xl font-bold mb-4">Подтверждение оплаты</h2>
            <div class="bg-gray-800/50 border border-[var(--border-color)] rounded-lg p-6 flex flex-col items-center gap-4">
                <p>Вы собираетесь оплатить <strong>129 ₽</strong> за пакет <strong>"12 фотографий"</strong>.</p>
                <p class="text-xs text-gray-500">Это симуляция. Нажмите "Оплатить" для получения кредитов.</p>
                <button id="payment-confirm-button" class="btn-primary w-full mt-4" style="background: linear-gradient(45deg, #10B981, #34D399);">
                    Оплатить 129 ₽
                </button>
            </div>
        </div>
      </div>
    </div>
    
    <!-- Main application script -->
    <script type="module" src="/index.tsx"></script>
    
  </body>
</html>